---
title: "GE_CustomerChurnModel"
author: "Clay Gendron"
date: "11/14/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

## Library Setup
  
```{r Establish Library}
library(tidymodels)
library(tidyverse)
library(here)
library(corrplot)
library(randomForest)
library(magrittr)
library(xgboost)
library(ggplot2)
library(rsample)
library(glmnet)
library(coefplot)
library(skimr)
library(recipes)
```

## Data Pull and Split

```{r Data}

# data pull
churn_dataset <- read.csv(here::here('Data/ge_cell_data.csv'))

# cal and val tables

churn_calibration <- churn_dataset %>% filter(CALIBRAT == 1)
churn_validation <- churn_dataset %>% filter(CALIBRAT == 0)

```

## Explorting Data

```{r EDA}

## Variable Selection for EDA Visuals

# output column names and summarise data
names(churn_dataset)
skim(churn_dataset)

# eliminate non usefull variables
var_mod1 <- lm(
  CHURNDEP ~ . - CHURN - CSA - OCC_LABEL, data=churn_calibration
)
summary(var_mod1)

# eliminate non important predictors variables - keep top 20 predictors
var_mod2 <- lm(
  CHURNDEP ~ 
    PRIZMRUR + CHANGEM + MAILORD + PHONES + MOUREC + 
    CHANGER + PRZM_NUM + PRIZMUB + OVERAGE + ROAM + 
    MODELS + WEBCAP + OCCCLER + REFURB + MOU +
    DROPBLK + BLCKVCE + CREDITGY + RETCALLS + SETPRC, 
  data=churn_calibration
)
summary(var_mod2)

coefplot(var_mod2, sort = "magnitude")

## Data Visualizations

# histograms and bars

ggplot(churn_calibration, aes(x = PRIZMRUR)) + geom_bar()
ggplot(churn_calibration, aes(x = CHANGEM)) + geom_histogram()
ggplot(churn_calibration, aes(x = MAILORD)) + geom_bar()
ggplot(churn_calibration, aes(x = PHONES)) + geom_bar()
ggplot(churn_calibration, aes(x = MOUREC)) + geom_histogram()
ggplot(churn_calibration, aes(x = CHANGER)) + geom_histogram()
ggplot(churn_calibration, aes(x = PRZM_NUM)) + geom_histogram()
ggplot(churn_calibration, aes(x = PRIZMUB)) + geom_bar()
ggplot(churn_calibration, aes(x = OVERAGE)) + geom_histogram()
ggplot(churn_calibration, aes(x = ROAM)) + geom_histogram()
ggplot(churn_calibration, aes(x = MODELS)) + geom_bar()
ggplot(churn_calibration, aes(x = WEBCAP)) + geom_bar()
ggplot(churn_calibration, aes(x = OCCCLER)) + geom_bar()
ggplot(churn_calibration, aes(x = REFURB)) + geom_bar()
ggplot(churn_calibration, aes(x = MOU)) + geom_histogram()
ggplot(churn_calibration, aes(x = DROPBLK)) + geom_histogram()
ggplot(churn_calibration, aes(x = BLCKVCE)) + geom_histogram()
ggplot(churn_calibration, aes(x = CREDITGY)) + geom_bar()
ggplot(churn_calibration, aes(x = RETCALLS)) + geom_bar()
ggplot(churn_calibration, aes(x = SETPRC)) + geom_bar()

```

## Recipies and Data Manipulations

```{r}

```



